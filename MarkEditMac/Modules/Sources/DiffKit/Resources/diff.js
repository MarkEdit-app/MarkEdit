(function(){"use strict";class p{diff(e,n,t={}){let l;typeof t=="function"?(l=t,t={}):"callback"in t&&(l=t.callback);const s=this.castInput(e,t),o=this.castInput(n,t),r=this.removeEmpty(this.tokenize(s,t)),u=this.removeEmpty(this.tokenize(o,t));return this.diffWithOptionsObj(r,u,t,l)}diffWithOptionsObj(e,n,t,l){var s;const o=a=>{if(a=this.postProcess(a,t),l){setTimeout(function(){l(a)},0);return}else return a},r=n.length,u=e.length;let c=1,f=r+u;t.maxEditLength!=null&&(f=Math.min(f,t.maxEditLength));const C=(s=t.timeout)!==null&&s!==void 0?s:1/0,P=Date.now()+C,h=[{oldPos:-1,lastComponent:void 0}];let m=this.extractCommon(h[0],n,e,0,t);if(h[0].oldPos+1>=u&&m+1>=r)return o(this.buildValues(h[0].lastComponent,n,e));let y=-1/0,j=1/0;const A=()=>{for(let a=Math.max(y,-c);a<=Math.min(j,c);a+=2){let v;const W=h[a-1],x=h[a+1];W&&(h[a-1]=void 0);let I=!1;if(x){const $=x.oldPos-a;I=x&&0<=$&&$<r}const F=W&&W.oldPos+1<u;if(!I&&!F){h[a]=void 0;continue}if(!F||I&&W.oldPos<x.oldPos?v=this.addToPath(x,!0,!1,0,t):v=this.addToPath(W,!1,!0,1,t),m=this.extractCommon(v,n,e,a,t),v.oldPos+1>=u&&m+1>=r)return o(this.buildValues(v.lastComponent,n,e))||!0;h[a]=v,v.oldPos+1>=u&&(j=Math.min(j,a-1)),m+1>=r&&(y=Math.max(y,a+1))}c++};if(l)(function a(){setTimeout(function(){if(c>f||Date.now()>P)return l(void 0);A()||a()},0)})();else for(;c<=f&&Date.now()<=P;){const a=A();if(a)return a}}addToPath(e,n,t,l,s){const o=e.lastComponent;return o&&!s.oneChangePerToken&&o.added===n&&o.removed===t?{oldPos:e.oldPos+l,lastComponent:{count:o.count+1,added:n,removed:t,previousComponent:o.previousComponent}}:{oldPos:e.oldPos+l,lastComponent:{count:1,added:n,removed:t,previousComponent:o}}}extractCommon(e,n,t,l,s){const o=n.length,r=t.length;let u=e.oldPos,c=u-l,f=0;for(;c+1<o&&u+1<r&&this.equals(t[u+1],n[c+1],s);)c++,u++,f++,s.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!s.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=u,c}equals(e,n,t){return t.comparator?t.comparator(e,n):e===n||!!t.ignoreCase&&e.toLowerCase()===n.toLowerCase()}removeEmpty(e){const n=[];for(let t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n}castInput(e,n){return e}tokenize(e,n){return Array.from(e)}join(e){return e.join("")}postProcess(e,n){return e}get useLongestToken(){return!1}buildValues(e,n,t){const l=[];let s;for(;e;)l.push(e),s=e.previousComponent,delete e.previousComponent,e=s;l.reverse();const o=l.length;let r=0,u=0,c=0;for(;r<o;r++){const f=l[r];if(f.removed)f.value=this.join(t.slice(c,c+f.count)),c+=f.count;else{if(!f.added&&this.useLongestToken){let C=n.slice(u,u+f.count);C=C.map(function(P,h){const m=t[c+h];return m.length>P.length?m:P}),f.value=this.join(C)}else f.value=this.join(n.slice(u,u+f.count));u+=f.count,f.added||(c+=f.count)}}return l}}class N extends p{}const q=new N;function M(i,e,n){return q.diff(i,e,n)}function O(i,e){let n;for(n=0;n<i.length&&n<e.length;n++)if(i[n]!=e[n])return i.slice(0,n);return i.slice(0,n)}function T(i,e){let n;if(!i||!e||i[i.length-1]!=e[e.length-1])return"";for(n=0;n<i.length&&n<e.length;n++)if(i[i.length-(n+1)]!=e[e.length-(n+1)])return i.slice(-n);return i.slice(-n)}function D(i,e,n){if(i.slice(0,e.length)!=e)throw Error(`string ${JSON.stringify(i)} doesn't start with prefix ${JSON.stringify(e)}; this is a bug`);return n+i.slice(e.length)}function S(i,e,n){if(!e)return i+n;if(i.slice(-e.length)!=e)throw Error(`string ${JSON.stringify(i)} doesn't end with suffix ${JSON.stringify(e)}; this is a bug`);return i.slice(0,-e.length)+n}function g(i,e){return D(i,e,"")}function E(i,e){return S(i,e,"")}function k(i,e){return e.slice(0,J(i,e))}function J(i,e){let n=0;i.length>e.length&&(n=i.length-e.length);let t=e.length;i.length<e.length&&(t=i.length);const l=Array(t);let s=0;l[0]=0;for(let o=1;o<t;o++){for(e[o]==e[s]?l[o]=l[s]:l[o]=s;s>0&&e[o]!=e[s];)s=l[s];e[o]==e[s]&&s++}s=0;for(let o=n;o<i.length;o++){for(;s>0&&i[o]!=e[s];)s=l[s];i[o]==e[s]&&s++}return s}function w(i){let e;for(e=i.length-1;e>=0&&i[e].match(/\s/);e--);return i.substring(e+1)}function d(i){const e=i.match(/^\s*/);return e?e[0]:""}const L="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",V=new RegExp(`[${L}]+|\\s+|[^${L}]`,"ug");class R extends p{equals(e,n,t){return t.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e.trim()===n.trim()}tokenize(e,n={}){let t;if(n.intlSegmenter){const o=n.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');t=Array.from(o.segment(e),r=>r.segment)}else t=e.match(V)||[];const l=[];let s=null;return t.forEach(o=>{/\s/.test(o)?s==null?l.push(o):l.push(l.pop()+o):s!=null&&/\s/.test(s)?l[l.length-1]==s?l.push(l.pop()+o):l.push(s+o):l.push(o),s=o}),l}join(e){return e.map((n,t)=>t==0?n:n.replace(/^\s+/,"")).join("")}postProcess(e,n){if(!e||n.oneChangePerToken)return e;let t=null,l=null,s=null;return e.forEach(o=>{o.added?l=o:o.removed?s=o:((l||s)&&z(t,s,l,o),t=o,l=null,s=null)}),(l||s)&&z(t,s,l,null),e}}const _=new R;function B(i,e,n){return n?.ignoreWhitespace!=null&&!n.ignoreWhitespace?H(i,e,n):_.diff(i,e,n)}function z(i,e,n,t){if(e&&n){const l=d(e.value),s=w(e.value),o=d(n.value),r=w(n.value);if(i){const u=O(l,o);i.value=S(i.value,o,u),e.value=g(e.value,u),n.value=g(n.value,u)}if(t){const u=T(s,r);t.value=D(t.value,r,u),e.value=E(e.value,u),n.value=E(n.value,u)}}else if(n){if(i){const l=d(n.value);n.value=n.value.substring(l.length)}if(t){const l=d(t.value);t.value=t.value.substring(l.length)}}else if(i&&t){const l=d(t.value),s=d(e.value),o=w(e.value),r=O(l,s);e.value=g(e.value,r);const u=T(g(l,r),o);e.value=E(e.value,u),t.value=D(t.value,l,u),i.value=S(i.value,l,l.slice(0,l.length-u.length))}else if(t){const l=d(t.value),s=w(e.value),o=k(s,l);e.value=E(e.value,o)}else if(i){const l=w(i.value),s=d(e.value),o=k(l,s);e.value=g(e.value,o)}}class Z extends p{tokenize(e){const n=new RegExp(`(\\r?\\n)|[${L}]+|[^\\S\\n\\r]+|[^${L}]`,"ug");return e.match(n)||[]}}const G=new Z;function H(i,e,n){return G.diff(i,e,n)}class Q extends p{constructor(){super(...arguments),this.tokenize=Y}equals(e,n,t){return t.ignoreWhitespace?((!t.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!t.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):t.ignoreNewlineAtEof&&!t.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(e,n,t)}}const U=new Q;function X(i,e,n){return U.diff(i,e,n)}function Y(i,e){e.stripTrailingCr&&(i=i.replace(/\r\n/g,`
`));const n=[],t=i.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(let l=0;l<t.length;l++){const s=t[l];l%2&&!e.newlineIsToken?n[n.length-1]+=s:n.push(s)}return n}window.diffLines=X,window.diffWords=B,window.diffChars=M})();
